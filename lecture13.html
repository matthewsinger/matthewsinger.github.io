<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><head><meta http-equiv="content-type" content="text/html; charset=utf-8"/><meta name="viewport" content="width=device-width, initial-scale=0.8"/><title>Lecture 13: Nested Data</title><link rel="stylesheet" type="text/css" href="scribble.css" title="default"/><link rel="stylesheet" type="text/css" href="extra-styles.css" title="default"/><link rel="stylesheet" type="text/css" href="ps-styles.css" title="default"/><link rel="stylesheet" type="text/css" href="racket.css" title="default"/><link rel="stylesheet" type="text/css" href="manual-style.css" title="default"/><link rel="stylesheet" type="text/css" href="manual-racket.css" title="default"/><script type="text/javascript" src="scribble-common.js"></script><script type="text/javascript" src="extra-scripts.js"></script><script type="text/javascript" src="manual-racket.js"></script><!--[if IE 6]><style type="text/css">.SIEHidden { overflow: hidden; }</style><![endif]--></head><body id="scribble-racket-lang-org"><div class="tocset"></div><div class="maincolumn"><div class="main"><div class="versionbox"><span class="version">7.3</span></div><div class="navsettop"><span class="navleft"><div class="nosearchform"></div>&nbsp;&nbsp;</span><span class="navright">&nbsp;&nbsp;<a href="lecture12.html" title="backward to &quot;Lecture 12: Structures&quot;" data-pltdoc="x">&larr; prev</a>&nbsp;&nbsp;<a href="Lectures.html" title="up to &quot;II Lectures&quot;" data-pltdoc="x">up</a>&nbsp;&nbsp;<a href="lecture14.html" title="forward to &quot;Lecture 14: 2D Motion&quot;" data-pltdoc="x">next &rarr;</a></span>&nbsp;</div><h3><a name="(part._lecture13)"></a>Lecture 13: Nested Data</h3><p><span style="font-weight: bold">Motivation:</span> We want to reason about nested data.</p><p><span style="font-weight: bold">Topics to cover:</span> Data definitions that refer to other data definitions</p><h4><a name="(part._g7470)"></a>Recap</h4><p>Any insights from the homework? What didn&rsquo;t people understand?</p><h4><a name="(part._g7471)"></a>Movie Purchases</h4><p>So we have our code from last lecture about movies:</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">A Movie is a (make-movie String String Boolean Number)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">define-struct</span><span class="hspace">&nbsp;</span><span class="RktSym">movie</span><span class="hspace">&nbsp;</span><span class="RktPn">[</span><span class="RktSym">name</span><span class="hspace">&nbsp;</span><span class="RktSym">genre</span><span class="hspace">&nbsp;</span><span class="RktSym">monochrome?</span><span class="hspace">&nbsp;</span><span class="RktSym">year</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">and represents a movie</span><span class="RktCmt">'</span><span class="RktCmt">s, name,</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktCmt">genre,</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">whether it is black and white or color, and year of release</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">casablanca</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">make-movie</span><span class="hspace">&nbsp;</span><span class="RktVal">"Casablanca"</span><span class="hspace">&nbsp;</span><span class="RktVal">"drama"</span><span class="hspace">&nbsp;</span><span class="RktVal">#t</span><span class="hspace">&nbsp;</span><span class="RktVal">1942</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">booksmart</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">make-movie</span><span class="hspace">&nbsp;</span><span class="RktVal">"Booksmart"</span><span class="hspace">&nbsp;</span><span class="RktVal">"comedy"</span><span class="hspace">&nbsp;</span><span class="RktVal">#f</span><span class="hspace">&nbsp;</span><span class="RktVal">2019</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">movie-temp : Movie -&gt; ?</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">movie-temp</span><span class="hspace">&nbsp;</span><span class="RktSym">movie</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">...</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">movie-name</span><span class="hspace">&nbsp;</span><span class="RktSym">movie</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">movie-genre</span><span class="hspace">&nbsp;</span><span class="RktSym">movie</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">movie-monochrome?</span><span class="hspace">&nbsp;</span><span class="RktSym">movie</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">movie-year</span><span class="hspace">&nbsp;</span><span class="RktSym">movie</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote><p>What does a movie purchase from a digital store include? The movie itself and the purchase option.
A purchase option includes a cost, whether it&rsquo;s in SD or HD, and a length of time you can keep the movie.
A length of time is either indefinite or a certain amount of days.</p><p>Let&rsquo;s convert this into a data definition.</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">A MoviePurchase is a (make-purchase Movie PurchaseOption)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">define-struct</span><span class="hspace">&nbsp;</span><span class="RktSym">purchase</span><span class="hspace">&nbsp;</span><span class="RktPn">[</span><span class="RktSym">movie</span><span class="hspace">&nbsp;</span><span class="RktSym">option</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">and represents the movie someone is purchasing and the option they</span><span class="RktCmt">'</span><span class="RktCmt">re choosing</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">A Movie is a (make-movie String String Boolean Number)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">define-struct</span><span class="hspace">&nbsp;</span><span class="RktSym">movie</span><span class="hspace">&nbsp;</span><span class="RktPn">[</span><span class="RktSym">name</span><span class="hspace">&nbsp;</span><span class="RktSym">genre</span><span class="hspace">&nbsp;</span><span class="RktSym">monochrome?</span><span class="hspace">&nbsp;</span><span class="RktSym">year</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">and represents a movie</span><span class="RktCmt">'</span><span class="RktCmt">s, name,</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktCmt">genre,</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">whether it is black and white or color, and year of release</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">A PurchaseOption is a (make-po NNN Quality PurchaseLength)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">define-struct</span><span class="hspace">&nbsp;</span><span class="RktSym">po</span><span class="hspace">&nbsp;</span><span class="RktPn">[</span><span class="RktSym">cost</span><span class="hspace">&nbsp;</span><span class="RktSym">quality</span><span class="hspace">&nbsp;</span><span class="RktSym">time</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">and represents the cost, quality, and time of purchase</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">A Quality is one of:</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">- "SD"</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">- "HD"</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">and represents standard or high definition</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">A PurchaseLength is one of:</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">- </span><span class="RktCmt">'</span><span class="RktCmt">indefinite</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">- Nat</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">and represents either an indefinite purcahse or the # of days to watch</span></td></tr></table></blockquote><p>How many data definitions do we have here? 5. How many groups of examples will we need?
5. How many templates? 5. Let&rsquo;s develop our examples. We develop our examples bottom-up
so that we can use them in other examples.</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">A MoviePurchase is a (make-purchase Movie PurchaseOption)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">define-struct</span><span class="hspace">&nbsp;</span><span class="RktSym">purchase</span><span class="hspace">&nbsp;</span><span class="RktPn">[</span><span class="RktSym">movie</span><span class="hspace">&nbsp;</span><span class="RktSym">option</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">and represents the movie someone is purchasing and the option they</span><span class="RktCmt">'</span><span class="RktCmt">re choosing</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">A Movie is a (make-movie String String Boolean Number)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">define-struct</span><span class="hspace">&nbsp;</span><span class="RktSym">movie</span><span class="hspace">&nbsp;</span><span class="RktPn">[</span><span class="RktSym">name</span><span class="hspace">&nbsp;</span><span class="RktSym">genre</span><span class="hspace">&nbsp;</span><span class="RktSym">monochrome?</span><span class="hspace">&nbsp;</span><span class="RktSym">year</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">and represents a movie</span><span class="RktCmt">'</span><span class="RktCmt">s, name,</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktCmt">genre,</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">whether it is black and white or color, and year of release</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">A PurchaseOption is a (make-po NNN Quality PurchaseLength)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">define-struct</span><span class="hspace">&nbsp;</span><span class="RktSym">po</span><span class="hspace">&nbsp;</span><span class="RktPn">[</span><span class="RktSym">cost</span><span class="hspace">&nbsp;</span><span class="RktSym">quality</span><span class="hspace">&nbsp;</span><span class="RktSym">time</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">and represents the cost, quality, and time of purchase</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">A Quality is one of:</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">- "SD"</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">- "HD"</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">and represents standard or high definition</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">A PurchaseLength is one of:</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">- </span><span class="RktCmt">'</span><span class="RktCmt">indefinite</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">- Nat</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">and represents either an indefinite purcahse or the # of days to watch</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">pl-ind</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">indefinite</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">pl-4</span><span class="hspace">&nbsp;</span><span class="RktVal">4</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">quality-sd</span><span class="hspace">&nbsp;</span><span class="RktVal">"SD"</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">quality-hd</span><span class="hspace">&nbsp;</span><span class="RktVal">"HD"</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">po-6hd4days</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">make-po</span><span class="hspace">&nbsp;</span><span class="RktVal">6</span><span class="hspace">&nbsp;</span><span class="RktSym">quality-hd</span><span class="hspace">&nbsp;</span><span class="RktSym">pl-4</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">po-8sd4indefinite</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">make-po</span><span class="hspace">&nbsp;</span><span class="RktVal">8</span><span class="hspace">&nbsp;</span><span class="RktSym">quality-sd</span><span class="hspace">&nbsp;</span><span class="RktSym">pl-ind</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">casablanca</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">make-movie</span><span class="hspace">&nbsp;</span><span class="RktVal">"Casablanca"</span><span class="hspace">&nbsp;</span><span class="RktVal">"drama"</span><span class="hspace">&nbsp;</span><span class="RktVal">#t</span><span class="hspace">&nbsp;</span><span class="RktVal">1942</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">booksmart</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">make-movie</span><span class="hspace">&nbsp;</span><span class="RktVal">"Booksmart"</span><span class="hspace">&nbsp;</span><span class="RktVal">"comedy"</span><span class="hspace">&nbsp;</span><span class="RktVal">#f</span><span class="hspace">&nbsp;</span><span class="RktVal">2019</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">purchase-casablanca</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">make-purchase</span><span class="hspace">&nbsp;</span><span class="RktSym">casablanca</span><span class="hspace">&nbsp;</span><span class="RktSym">po-6hd4days</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">purchase-booksmart</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">make-purchase</span><span class="hspace">&nbsp;</span><span class="RktSym">booksmart</span><span class="hspace">&nbsp;</span><span class="RktSym">po-8sd4indefinite</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote><p>Now let&rsquo;s try and develop the template for MoviePurchase.</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">moviepurchase-temp : MoviePurchase -&gt; ?</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">moviepurchase-temp</span><span class="hspace">&nbsp;</span><span class="RktSym">mp</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">...</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">moviepurchase-movie</span><span class="hspace">&nbsp;</span><span class="RktSym">mp</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">moviepurchase-option</span><span class="hspace">&nbsp;</span><span class="RktSym">mp</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote><p>But there&rsquo;s a lot of data inside those two fields! How should we access them?
Listing all of the fields? That would add 6 fields to the template. That feels verbose.
Instead, we&rsquo;re going to <span style="font-style: italic">call the templates</span> of a Movie and PurchaseOption.</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">moviepurchase-temp : MoviePurchase -&gt; ?</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">moviepurchase-temp</span><span class="hspace">&nbsp;</span><span class="RktSym">mp</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">...</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">movie-temp</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">moviepurchase-movie</span><span class="hspace">&nbsp;</span><span class="RktSym">mp</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">purchaseoption-temp</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">moviepurchase-option</span><span class="hspace">&nbsp;</span><span class="RktSym">mp</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">movie-temp : Movie -&gt; ?</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">movie-temp</span><span class="hspace">&nbsp;</span><span class="RktSym">movie</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">...</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">movie-name</span><span class="hspace">&nbsp;</span><span class="RktSym">movie</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">movie-genre</span><span class="hspace">&nbsp;</span><span class="RktSym">movie</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">movie-monochrome?</span><span class="hspace">&nbsp;</span><span class="RktSym">movie</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">movie-year</span><span class="hspace">&nbsp;</span><span class="RktSym">movie</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">purchaseoption-temp : PurchaseOption -&gt; ?</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">purchaseoption-temp</span><span class="hspace">&nbsp;</span><span class="RktSym">po</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">...</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">po-cost</span><span class="hspace">&nbsp;</span><span class="RktSym">po</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">quality-temp</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">po-quality</span><span class="hspace">&nbsp;</span><span class="RktSym">po</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">pl-temp</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">po-time</span><span class="hspace">&nbsp;</span><span class="RktSym">po</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">quality-temp : Quality -&gt; ?</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">quality-temp</span><span class="hspace">&nbsp;</span><span class="RktSym">quality</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cond</span><span class="hspace">&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym">string=?</span><span class="hspace">&nbsp;</span><span class="RktSym">quality</span><span class="hspace">&nbsp;</span><span class="RktSym">quality-sd</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">...</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym">string=?</span><span class="hspace">&nbsp;</span><span class="RktSym">quality</span><span class="hspace">&nbsp;</span><span class="RktSym">quality-hd</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">...</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">pl-temp : PurchaseLength -&gt; ?</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">pl-temp</span><span class="hspace">&nbsp;</span><span class="RktSym">pl</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cond</span><span class="hspace">&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym">symbol?</span><span class="hspace">&nbsp;</span><span class="RktSym">pl</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">...</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym">number?</span><span class="hspace">&nbsp;</span><span class="RktSym">pl</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">...</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote><p>So now let&rsquo;s see how these templates are useful. Let&rsquo;s design a function, which given
a purchase, outputs "MovieTitle (Year) for $Cost in Quality for Days/to own". Whenever we see
a call to another template, that&rsquo;s a sign to call a helper function that takes in that type.</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">purchase-desc : MoviePurchase -&gt; String</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">Describe the purchase</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">purchase-desc</span><span class="hspace">&nbsp;</span><span class="RktSym">mp</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">string-append</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">movie-description</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">purchase-movie</span><span class="hspace">&nbsp;</span><span class="RktSym">mp</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">" for "</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">purchase-description</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">purchase-option</span><span class="hspace">&nbsp;</span><span class="RktSym">mp</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">check-expect</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">purchase-desc</span><span class="hspace">&nbsp;</span><span class="RktSym">purchase-casablanca</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">"Casablanca (1942) for $6 in high definition for 4 days"</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">check-expect</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">purchase-desc</span><span class="hspace">&nbsp;</span><span class="RktSym">purchase-booksmart</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">"Booksmart (2019) for $8 in standard definition to own"</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">movie-description : Movie -&gt; String</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">Describe the movie</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">movie-description</span><span class="hspace">&nbsp;</span><span class="RktSym">movie</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">string-append</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">movie-name</span><span class="hspace">&nbsp;</span><span class="RktSym">movie</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">" ("</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">number-&gt;string</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">movie-year</span><span class="hspace">&nbsp;</span><span class="RktSym">movie</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">")"</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">check-expect</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">movie-description</span><span class="hspace">&nbsp;</span><span class="RktSym">casablanca</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">"Casablanca (1942)"</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">check-expect</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">movie-description</span><span class="hspace">&nbsp;</span><span class="RktSym">booksmart</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">"Booksmart (2019)"</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">purchase-description : PurchaseOption -&gt; String</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">Descrive the purchase</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">purchase-description</span><span class="hspace">&nbsp;</span><span class="RktSym">po</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">string-append</span><span class="hspace">&nbsp;</span><span class="RktVal">"$"</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">number-&gt;string</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">po-cost</span><span class="hspace">&nbsp;</span><span class="RktSym">po</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">" in "</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">quality-description</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">po-quality</span><span class="hspace">&nbsp;</span><span class="RktSym">po</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">" "</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">pl-description</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">po-time</span><span class="hspace">&nbsp;</span><span class="RktSym">po</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">check-expect</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">purchase-description</span><span class="hspace">&nbsp;</span><span class="RktSym">po-6hd4days</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">"$6 in high definition for 4 days"</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">check-expect</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">purchase-description</span><span class="hspace">&nbsp;</span><span class="RktSym">po-8sd4indefinite</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">"$8 in standard definition to own"</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">quality-description : Quality -&gt; String</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">Describe the quality</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">quality-description</span><span class="hspace">&nbsp;</span><span class="RktSym">quality</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cond</span><span class="hspace">&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym">string=?</span><span class="hspace">&nbsp;</span><span class="RktSym">quality</span><span class="hspace">&nbsp;</span><span class="RktSym">quality-sd</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">"standard definition"</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym">string=?</span><span class="hspace">&nbsp;</span><span class="RktSym">quality</span><span class="hspace">&nbsp;</span><span class="RktSym">quality-hd</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">"high definition"</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">check-expect</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">quality-description</span><span class="hspace">&nbsp;</span><span class="RktSym">quality-hd</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">"high definition"</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">check-expect</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">quality-description</span><span class="hspace">&nbsp;</span><span class="RktSym">quality-sd</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">"standard definition"</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">pl-description : PurchaseLength -&gt; String</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">Describe the time (in so far as it relates to a purchase)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">pl-description</span><span class="hspace">&nbsp;</span><span class="RktSym">pl</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cond</span><span class="hspace">&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym">symbol?</span><span class="hspace">&nbsp;</span><span class="RktSym">pl</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">"to own"</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym">number?</span><span class="hspace">&nbsp;</span><span class="RktSym">pl</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">string-append</span><span class="hspace">&nbsp;</span><span class="RktVal">"for "</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">number-&gt;string</span><span class="hspace">&nbsp;</span><span class="RktSym">pl</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">" days"</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">check-expect</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">pl-description</span><span class="hspace">&nbsp;</span><span class="RktSym">pl-ind</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">"to own"</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">check-expect</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">pl-description</span><span class="hspace">&nbsp;</span><span class="RktSym">pl-4</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">"for 4 days"</span><span class="RktPn">)</span></td></tr></table></blockquote><p>Following the template all the way through isn&rsquo;t exactly glamorous but it&rsquo;s the only way
to get code correct for complex data definitions.</p><ol><li><p>How many cases of the data are there?</p></li><li><p>How do I tell them apart?</p></li><li><p>What data can I extract from each?</p></li><li><p>What complex data types are contained within, so what templates do I call?</p></li></ol><h4><a name="(part._g7472)"></a>If more time is needed</h4><p>If more time is needed, create some metric for whether or not a purchase is worth it
(after some year, less than some cost, in hd, for some amount of time, etc.)
and follow the function through, sticking to the template. One function per data
defintion.</p><div class="navsetbottom"><span class="navleft"><div class="nosearchform"></div>&nbsp;&nbsp;</span><span class="navright">&nbsp;&nbsp;<a href="lecture12.html" title="backward to &quot;Lecture 12: Structures&quot;" data-pltdoc="x">&larr; prev</a>&nbsp;&nbsp;<a href="Lectures.html" title="up to &quot;II Lectures&quot;" data-pltdoc="x">up</a>&nbsp;&nbsp;<a href="lecture14.html" title="forward to &quot;Lecture 14: 2D Motion&quot;" data-pltdoc="x">next &rarr;</a></span>&nbsp;</div></div></div><div id="contextindicator">&nbsp;</div></body></html>